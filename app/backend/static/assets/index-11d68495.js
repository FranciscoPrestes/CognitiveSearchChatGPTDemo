import{j as ge,r as s,a as qe}from"./react-a9b6c34a.js";import{a as Me,c as $e}from"./react-dom-2c65b678.js";import{L as ze,N as ke,H as De}from"./react-router-dom-e5f3a2d5.js";import{O as Qe,d as Oe,e as ae}from"./react-router-0030e45b.js";import{S as Ae,A as Re,a as Fe,R as ie,b as je,C as He,c as Ge}from"./microsoft-cognitiveservices-speech-sdk-6e793f52.js";import{p as Pe}from"./dompurify-76a5efca.js";import{S as Ue,a as B,I as ce,E as Ke,P as Ve,T as V,B as We,b as Je,c as Xe,d as le,e as Ye,f as Le,g as Ie,h as _e,D as Ce,C as Ze,i as Se,j as X,k as et,l as tt,m as nt}from"./@fluentui-a8ae1eaa.js";import{J as ot,i as st}from"./@react-spring-1dc2420c.js";import"./bent-d4cce1f4.js";import"./scheduler-04ce0582.js";import"./@remix-run-88f74c5a.js";import"./uuid-a960c1f4.js";import"./tslib-14a4c710.js";import"./@microsoft-31b40247.js";import"./@griffel-cbe60fd0.js";import"./rtl-css-js-4ed993c7.js";import"./@emotion-8a8e73f6.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function a(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(o){if(o.ep)return;o.ep=!0;const i=a(o);fetch(o.href,i)}})();const ue=ge.Fragment,e=ge.jsx,d=ge.jsxs;const at="/assets/github-fab00c2d.svg",rt="_layout_o4bzc_1",it="_header_o4bzc_13",ct="_headerContainer_o4bzc_23",lt="_headerTitleContainer_o4bzc_39",dt="_headerLogo_o4bzc_55",ht="_headerTitle_o4bzc_39",ut="_headerNavList_o4bzc_73",pt="_headerNavPageLink_o4bzc_85",mt="_headerNavPageLinkActive_o4bzc_113",gt="_headerNavLeftMargin_o4bzc_123",_t="_headerRightText_o4bzc_131",Ct="_microsoftLogo_o4bzc_141",St="_githubLogo_o4bzc_151",R={layout:rt,header:it,headerContainer:ct,headerTitleContainer:lt,headerLogo:dt,headerTitle:ht,headerNavList:ut,headerNavPageLink:pt,headerNavPageLinkActive:mt,headerNavLeftMargin:gt,headerRightText:_t,microsoftLogo:Ct,githubLogo:St},ft=()=>d("div",{className:R.layout,children:[e("header",{className:R.header,role:"banner",children:d("div",{className:R.headerContainer,children:[e(ze,{to:"/",className:R.headerTitleContainer,children:e("h3",{className:R.headerTitle,children:"GPT + Enterprise data | Sample"})}),e("nav",{children:d("ul",{className:R.headerNavList,children:[e("li",{children:e(ke,{to:"/",className:({isActive:t})=>t?R.headerNavPageLinkActive:R.headerNavPageLink,children:"Chat"})}),e("li",{className:R.headerNavLeftMargin,children:e(ke,{to:"/qa",className:({isActive:t})=>t?R.headerNavPageLinkActive:R.headerNavPageLink,children:"Ask a question"})}),e("li",{className:R.headerNavLeftMargin,children:e("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e("img",{src:at,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:R.githubLogo})})})]})}),e("h4",{className:R.headerRightText,children:"Azure OpenAI + Cognitive Search"})]})}),e(Qe,{})]}),vt=()=>e("h1",{children:"404"}),yt="_oneshotContainer_1x7b2_1",bt="_oneshotTopSection_1x7b2_15",Tt="_oneshotBottomSection_1x7b2_29",Nt="_oneshotTitle_1x7b2_49",kt="_oneshotQuestionInput_1x7b2_77",xt="_oneshotAnswerContainer_1x7b2_91",wt="_oneshotAnalysisPanel_1x7b2_105",At="_oneshotSettingsSeparator_1x7b2_115",Rt="_settingsButton_1x7b2_123",b={oneshotContainer:yt,oneshotTopSection:bt,oneshotBottomSection:Tt,oneshotTitle:Nt,oneshotQuestionInput:kt,oneshotAnswerContainer:xt,oneshotAnalysisPanel:wt,oneshotSettingsSeparator:At,settingsButton:Rt};async function Pt(t){var l,o,i,u,f,r,g,c;const n=await fetch("/askBing",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t.question,approach:t.approach,overrides:{semantic_ranker:(l=t.overrides)==null?void 0:l.semanticRanker,semantic_captions:(o=t.overrides)==null?void 0:o.semanticCaptions,top:(i=t.overrides)==null?void 0:i.top,temperature:(u=t.overrides)==null?void 0:u.temperature,prompt_template:(f=t.overrides)==null?void 0:f.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(g=t.overrides)==null?void 0:g.promptTemplateSuffix,exclude_category:(c=t.overrides)==null?void 0:c.excludeCategory}})}),a=await n.json();if(n.status>299||!n.ok)throw Error(a.error||"Unknown error");return a}async function Lt(t){var l,o,i,u,f,r,g,c;const n=await fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t.question,approach:t.approach,overrides:{semantic_ranker:(l=t.overrides)==null?void 0:l.semanticRanker,semantic_captions:(o=t.overrides)==null?void 0:o.semanticCaptions,top:(i=t.overrides)==null?void 0:i.top,temperature:(u=t.overrides)==null?void 0:u.temperature,prompt_template:(f=t.overrides)==null?void 0:f.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(g=t.overrides)==null?void 0:g.promptTemplateSuffix,exclude_category:(c=t.overrides)==null?void 0:c.excludeCategory}})}),a=await n.json();if(n.status>299||!n.ok)throw Error(a.error||"Unknown error");return a}async function It(t){var l,o,i,u,f,r,g,c,m;const n=await fetch("/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:t.history,approach:t.approach,overrides:{semantic_ranker:(l=t.overrides)==null?void 0:l.semanticRanker,semantic_captions:(o=t.overrides)==null?void 0:o.semanticCaptions,top:(i=t.overrides)==null?void 0:i.top,temperature:(u=t.overrides)==null?void 0:u.temperature,prompt_template:(f=t.overrides)==null?void 0:f.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(g=t.overrides)==null?void 0:g.promptTemplateSuffix,exclude_category:(c=t.overrides)==null?void 0:c.excludeCategory,suggest_followup_questions:(m=t.overrides)==null?void 0:m.suggestFollowupQuestions}})}),a=await n.json();if(n.status>299||!n.ok)throw Error(a.error||"Unknown error");return a}async function Bt(t){const n="e985cb0392ad45d59681a396b208ebcf",a="southcentralus";var l=Ae.fromSubscription(n,a);const o=Re.fromDefaultSpeakerOutput();l.speechSynthesisVoiceName="zh-CN-YunxiNeural";const i=new Fe(l,o),f=t.answer.replace(/\[[^\]]*\]/g,"");console.log(t.answer),i.speakTextAsync(f,function(r){r.reason===ie.SynthesizingAudioCompleted?console.log("synthesis finished."):console.error("Speech synthesis canceled, "+r.errorDetails+`
Did you set the speech resource key and region values?`),i.close()},function(r){console.trace("err - "+r),i.close()})}function Et(t){return`/content/${t}`}var F=(t=>(t.RetrieveThenRead="rtr",t.ReadRetrieveRead="rrr",t.ReadDecomposeAsk="rda",t))(F||{}),pe=(t=>(t.BingSearch="bing",t))(pe||{});const qt="_answerContainer_1tryd_1",Mt="_answerLogo_1tryd_17",$t="_answerText_1tryd_25",zt="_selected_1tryd_43",Dt="_citationLearnMore_1tryd_51",Qt="_citation_1tryd_51",Ot="_followupQuestionsList_1tryd_95",Ft="_followupQuestionLearnMore_1tryd_103",jt="_followupQuestion_1tryd_95",Ht="_supContainer_1tryd_141",Gt="_retryButton_1tryd_199",Ut="_loadingdots_1tryd_243",Kt="_loading_1tryd_243",P={answerContainer:qt,answerLogo:Mt,answerText:$t,selected:zt,citationLearnMore:Dt,citation:Qt,followupQuestionsList:Ot,followupQuestionLearnMore:Ft,followupQuestion:jt,supContainer:Ht,retryButton:Gt,loadingdots:Ut,loading:Kt};function Vt(t,n){const a=[],l=[];let o=t.replace(/<<([^>>]+)>>/g,(r,g)=>(l.push(g),""));o=o.trim();const i=o.split(/\[([^\]]+)\]+\(([^\)]+)\)/g);console.log(i);let u=o.match(/\[([^\]]+)\]+\(([^\)]+)\)/g);return console.log(u),u&&u.map((r,g)=>{const c=r.split("]")[0].replace("[",""),m=r.split("]")[1].replace("(","").replace(")","");console.log(c),console.log(m),a.push({id:g,name:c,path:m})}),{answerHtml:i.map((r,g)=>{if(g%3===0)return r;if(g%3==1){let c=a.find(O=>O.name==r),m=c?c.id:-1;m!==-1?m=c?c.id+1:-1:m=a.length;const v=Et(r);return Me(e("a",{className:"supContainer",title:r,onClick:()=>n(v),children:e("sup",{children:m})}))}else return""}).join(""),citations:a,followupQuestions:l}}const Be=()=>e(Ue,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),fe=({answer:t,isSelected:n,onCitationClicked:a,onThoughtProcessClicked:l,onSupportingContentClicked:o,onFollowupQuestionClicked:i,onReadAnswerClicked:u,showFollowupQuestions:f})=>{const r=s.useMemo(()=>Vt(t.answer,a),[t]),g=Pe.sanitize(r.answerHtml);return d(B,{className:`${P.answerContainer} ${n&&P.selected}`,verticalAlign:"space-between",children:[e(B.Item,{children:d(B,{horizontal:!0,horizontalAlign:"space-between",children:[e(Be,{}),d("div",{children:[e(ce,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>l(),disabled:!t.thoughts}),e(ce,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>o(),disabled:!t.data_points.length}),e(ce,{style:{color:"black"},iconProps:{iconName:"ReadOutLoud"},title:"Read answer",ariaLabel:"Read answer",onClick:()=>u(),disabled:!t.answer})]})]})}),e(B.Item,{grow:!0,children:e("div",{className:P.answerText,dangerouslySetInnerHTML:{__html:g}})}),!!r.citations.length&&e(B.Item,{children:d(B,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e("span",{className:P.citationLearnMore,children:"来源:"}),r.citations.map((c,m)=>{const v=c.path;return e("a",{className:P.citation,title:c.name,onClick:()=>a(v),children:`${++m}. ${c.name}`},m)})]})}),!!r.followupQuestions.length&&f&&i&&e(B.Item,{children:d(B,{horizontal:!0,wrap:!0,className:`${r.citations.length?P.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e("span",{className:P.followupQuestionLearnMore,children:"您可能还想问:"}),r.followupQuestions.map((c,m)=>e("a",{className:P.followupQuestion,title:c,onClick:()=>i(c),children:`${c}`},m))]})})]})},Wt=()=>{const t=ot({from:{opacity:0},to:{opacity:1}});return e(st.div,{style:{...t},children:d(B,{className:P.answerContainer,verticalAlign:"space-between",children:[e(Be,{}),e(B.Item,{grow:!0,children:d("p",{className:P.answerText,children:["正在生成回答",e("span",{className:P.loadingdots})]})})]})})},ve=({error:t,onRetry:n})=>d(B,{className:P.answerContainer,verticalAlign:"space-between",children:[e(Ke,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e(B.Item,{grow:!0,children:e("p",{className:P.answerText,children:t})}),e(Ve,{className:P.retryButton,onClick:n,text:"Retry"})]}),Jt="_questionInputContainer_wokwf_1",Xt="_questionInputTextArea_wokwf_19",Yt="_questionInputButtonsContainer_wokwf_29",Zt="_questionInputSendButton_wokwf_41",en="_questionInputSendButtonDisabled_wokwf_49",J={questionInputContainer:Jt,questionInputTextArea:Xt,questionInputButtonsContainer:Yt,questionInputSendButton:Zt,questionInputSendButtonDisabled:en},ye=({onSend:t,disabled:n,placeholder:a,clearOnSend:l})=>{const[o,i]=s.useState(""),u=()=>{if(n||!o.trim()){console.log("send disabled"),console.log("question: "+o);return}t(o),l&&i("")},f=()=>{const m="e985cb0392ad45d59681a396b208ebcf",v="southcentralus";var O=Ae.fromSubscription(m,v);const x=Re.fromDefaultMicrophoneInput();O.speechRecognitionLanguage="zh-CN";const j=new je(O,x);j.recognizeOnceAsync(w=>{switch(w.reason){case ie.RecognizedSpeech:console.log(`RECOGNIZED: Text=${w.text}`),i(w.text);break;case ie.NoMatch:console.log("NOMATCH: Speech could not be recognized.");break;case ie.Canceled:const E=He.fromResult(w);console.log(`CANCELED: Reason=${E.reason}`),E.reason==Ge.Error&&(console.log(`CANCELED: ErrorCode=${E.ErrorCode}`),console.log(`CANCELED: ErrorDetails=${E.errorDetails}`),console.log("CANCELED: Did you set the speech resource key and region values?"));break}j.close()})},r=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),u())},g=(m,v)=>{v?v.length<=1e3&&i(v):i("")},c=n||!o.trim();return d(B,{horizontal:!0,className:J.questionInputContainer,children:[e(V,{className:J.questionInputTextArea,placeholder:a,multiline:!0,resizable:!1,borderless:!0,value:o,onChange:g,onKeyDown:r}),d("div",{className:J.questionInputButtonsContainer,children:[e("div",{className:`${J.questionInputSendButton} ${c?J.questionInputSendButtonDisabled:""}`,"aria-label":"语音输入",onClick:f,children:e(We,{primaryFill:"rgba(115, 118, 225, 1)"})}),e("div",{className:`${J.questionInputSendButton} ${c?J.questionInputSendButtonDisabled:""}`,"aria-label":"提问按钮",onClick:u,children:e(Je,{primaryFill:"rgba(115, 118, 225, 1)"})})]})]})},tn="_examplesNavList_v5q0z_1",nn="_example_v5q0z_1",on="_exampleText_v5q0z_53",me={examplesNavList:tn,example:nn,exampleText:on},sn=({text:t,value:n,onClick:a})=>e("div",{className:me.example,onClick:()=>a(n),children:e("p",{className:me.exampleText,children:t})}),an=[{text:"正常DMS计算公式是什么?",value:"正常DMS计算公式是什么?"},{text:"进货未销定义是什么?",value:"进货未销定义?"},{text:"APP与OSPC端门店货源查询退货状态不一致 门店商品退货状态系统逻辑?",value:"APP与OSPC端门店货源查询退货状态不一致 门店商品退货状态系统逻辑?"}],be=({onExampleClicked:t})=>e("ul",{className:me.examplesNavList,children:an.map((n,a)=>e("li",{children:e(sn,{text:n.text,value:n.value,onClick:t})},a))}),rn="_thoughtProcess_exr0t_1",cn={thoughtProcess:rn};function ln(t){const n=t.split(": "),a=n[0];var l=n.slice(1).join(": ")?n.slice(1).join(": "):"No content";const o=l.match(/<([^>]+)>/);return l=l.replace(/<([^>]+)>/g,""),{title:a,content:l,url:o?o[1]:""}}const dn="_supportingContentNavList_ekyxv_1",hn="_supportingContentItem_ekyxv_17",un="_supportingContentItemHeader_ekyxv_41",pn="_supportingContentItemText_ekyxv_49",re={supportingContentNavList:dn,supportingContentItem:hn,supportingContentItemHeader:un,supportingContentItemText:pn},mn=({supportingContent:t})=>e("ul",{className:re.supportingContentNavList,children:t.map((n,a)=>{const l=ln(n);return d("li",{className:re.supportingContentItem,children:[e("h4",{className:re.supportingContentItemHeader,children:l.title}),e("p",{className:re.supportingContentItemText,children:l.content}),e("a",{className:re.supportingContentItemText,href:l.url,target:"_blank",children:l.url})]})})});var k=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(k||{});const de={disabled:!0,style:{color:"grey"}},Te=({answer:t,activeTab:n,activeCitation:a,citationHeight:l,className:o,onActiveTabChanged:i})=>{const u=!t.thoughts,f=!t.data_points.length,r=!a,g=Pe.sanitize(t.thoughts);return d(Xe,{className:o,selectedKey:n,onLinkClick:c=>c&&i(c.props.itemKey),children:[e(le,{itemKey:k.ThoughtProcessTab,headerText:"思维过程",headerButtonProps:u?de:void 0,children:e("div",{className:cn.thoughtProcess,dangerouslySetInnerHTML:{__html:g}})}),e(le,{itemKey:k.SupportingContentTab,headerText:"支持内容",headerButtonProps:f?de:void 0,children:e(mn,{supportingContent:t.data_points})}),e(le,{itemKey:k.CitationTab,headerText:"引用",headerButtonProps:r?de:void 0,children:e("iframe",{title:"引用",src:a,width:"100%",height:l})})]})},gn="_container_1k5c7_1",_n={container:gn},Ne=({className:t,onClick:n})=>d("div",{className:`${_n.container} ${t??""}`,onClick:n,children:[e(Ye,{}),e(Le,{children:"开发人员配置"})]}),Cn=()=>{const[t,n]=s.useState(!1),[a,l]=s.useState(F.ReadDecomposeAsk),[o,i]=s.useState(""),[u,f]=s.useState(""),[r,g]=s.useState(""),[c,m]=s.useState(3),[v,O]=s.useState(!1),[x,j]=s.useState(!1),[w,E]=s.useState(""),q=s.useRef(""),[M,K]=s.useState(!1),[L,D]=s.useState(),[T,H]=s.useState(),[G,$]=s.useState(),[z,N]=s.useState(void 0),U=async C=>{q.current=C,L&&D(void 0),K(!0),$(void 0),N(void 0);try{const S={question:C,approach:a,overrides:{promptTemplate:o.length===0?void 0:o,promptTemplatePrefix:u.length===0?void 0:u,promptTemplateSuffix:r.length===0?void 0:r,excludeCategory:w.length===0?void 0:w,top:c,semanticRanker:v,semanticCaptions:x}},Ee=await Lt(S);H(Ee)}catch(S){D(S)}finally{K(!1)}},Y=(C,S)=>{i(S||"")},Z=(C,S)=>{f(S||"")},ee=(C,S)=>{g(S||"")},te=(C,S)=>{m(parseInt(S||"3"))},ne=(C,S)=>{l((S==null?void 0:S.key)||F.RetrieveThenRead)},oe=(C,S)=>{O(!!S)},W=(C,S)=>{j(!!S)},se=(C,S)=>{E(S||"")},_=C=>{U(C)},A=C=>{G===C&&z===k.CitationTab?N(void 0):($(C),N(k.CitationTab))},h=C=>{N(z===C?void 0:C)},p=()=>{alert("onReadAnswerClicked")},Q=[{key:F.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:F.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:F.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return d("div",{className:b.oneshotContainer,children:[d("div",{className:b.oneshotTopSection,children:[e(Ne,{className:b.settingsButton,onClick:()=>n(!t)}),e("h1",{className:b.oneshotTitle,children:"Ask your data"}),e("div",{className:b.oneshotQuestionInput,children:e(ye,{placeholder:"示例:面条是否可以用体外模拟进行GI测试？?",disabled:M,onSend:C=>U(C)})})]}),d("div",{className:b.oneshotBottomSection,children:[M&&e(Ie,{label:"正在生成回答"}),!q.current&&e(be,{onExampleClicked:_}),!M&&T&&!L&&e("div",{className:b.oneshotAnswerContainer,children:e(fe,{answer:T,onCitationClicked:C=>A(C),onThoughtProcessClicked:()=>h(k.ThoughtProcessTab),onSupportingContentClicked:()=>h(k.SupportingContentTab),onReadAnswerClicked:()=>p()})}),L?e("div",{className:b.oneshotAnswerContainer,children:e(ve,{error:L.toString(),onRetry:()=>U(q.current)})}):null,z&&T&&e(Te,{className:b.oneshotAnalysisPanel,activeCitation:G,onActiveTabChanged:C=>h(C),citationHeight:"600px",answer:T,activeTab:z})]}),d(_e,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>n(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(Ce,{onClick:()=>n(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(Ze,{className:b.oneshotSettingsSeparator,label:"方式",options:Q,defaultSelectedKey:a,onChange:ne}),(a===F.RetrieveThenRead||a===F.ReadDecomposeAsk)&&e(V,{className:b.oneshotSettingsSeparator,defaultValue:o,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:Y}),a===F.ReadRetrieveRead&&d(ue,{children:[e(V,{className:b.oneshotSettingsSeparator,defaultValue:u,label:"更改提问前缀模板",multiline:!0,autoAdjustHeight:!0,onChange:Z}),e(V,{className:b.oneshotSettingsSeparator,defaultValue:r,label:"更改提问后缀模板",multiline:!0,autoAdjustHeight:!0,onChange:ee})]}),e(Se,{className:b.oneshotSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:c.toString(),onChange:te}),e(V,{className:b.oneshotSettingsSeparator,label:"排除类别",onChange:se}),e(X,{className:b.oneshotSettingsSeparator,checked:v,label:"使用语义搜索",onChange:oe}),e(X,{className:b.oneshotSettingsSeparator,checked:x,label:"使用查询上下文摘要而不是整个文档",onChange:W,disabled:!v})]})]})},Sn="_container_1qf1y_1",fn="_chatRoot_1qf1y_15",vn="_chatContainer_1qf1y_25",yn="_chatEmptyState_1qf1y_41",bn="_chatEmptyStateTitle_1qf1y_61",Tn="_chatEmptyStateSubtitle_1qf1y_75",Nn="_chatMessageStream_1qf1y_107",kn="_chatMessageGpt_1qf1y_131",xn="_chatMessageGptMinWidth_1qf1y_145",wn="_chatInput_1qf1y_155",An="_chatAnalysisPanel_1qf1y_181",Rn="_chatSettingsSeparator_1qf1y_197",Pn="_loadingLogo_1qf1y_205",Ln="_commandsContainer_1qf1y_213",In="_commandButton_1qf1y_223",y={container:Sn,chatRoot:fn,chatContainer:vn,chatEmptyState:yn,chatEmptyStateTitle:bn,chatEmptyStateSubtitle:Tn,chatMessageStream:Nn,chatMessageGpt:kn,chatMessageGptMinWidth:xn,chatInput:wn,chatAnalysisPanel:An,chatSettingsSeparator:Rn,loadingLogo:Pn,commandsContainer:Ln,commandButton:In},Bn="_container_u4tj7_1",En="_message_u4tj7_17",xe={container:Bn,message:En},he=({message:t})=>e("div",{className:xe.container,children:e("div",{className:xe.message,children:t})}),qn="_container_7708a_1",Mn="_disabled_7708a_15",we={container:qn,disabled:Mn},$n=({className:t,disabled:n,onClick:a})=>d("div",{className:`${we.container} ${t??""} ${n&&we.disabled}`,onClick:a,children:[e(et,{}),e(Le,{children:"清空对话"})]}),zn=()=>{const[t,n]=s.useState(!1),[a,l]=s.useState(""),[o,i]=s.useState(3),[u,f]=s.useState(!1),[r,g]=s.useState(!1),[c,m]=s.useState(""),[v,O]=s.useState(!0),x=s.useRef(""),j=s.useRef(null),[w,E]=s.useState(!1),[q,M]=s.useState(),[K,L]=s.useState(),[D,T]=s.useState(void 0),[H,G]=s.useState(0),[$,z]=s.useState([]),N=async h=>{x.current=h,q&&M(void 0),E(!0),L(void 0),T(void 0);try{const Q={history:[...$.map(S=>({user:S[0],bot:S[1].answer})),{user:h,bot:void 0}],approach:F.ReadRetrieveRead,overrides:{promptTemplate:a.length===0?void 0:a,excludeCategory:c.length===0?void 0:c,top:o,semanticRanker:u,semanticCaptions:r,suggestFollowupQuestions:v}},C=await It(Q);z([...$,[h,C]])}catch(p){M(p)}finally{E(!1)}},U=()=>{x.current="",q&&M(void 0),L(void 0),T(void 0),z([])};s.useEffect(()=>{var h;return(h=j.current)==null?void 0:h.scrollIntoView({behavior:"smooth"})},[w]);const Y=(h,p)=>{l(p||"")},Z=(h,p)=>{i(parseInt(p||"3"))},ee=(h,p)=>{f(!!p)},te=(h,p)=>{g(!!p)},ne=(h,p)=>{m(p||"")},oe=(h,p)=>{O(!!p)},W=h=>{N(h)},se=(h,p)=>{K===h&&D===k.CitationTab&&H===p?T(void 0):(L(h),T(k.CitationTab)),G(p)},_=(h,p)=>{T(D===h&&H===p?void 0:h),G(p)},A=async(h,p)=>{G(p);try{const Q={answer:h.answer};await Bt(Q)}catch(Q){M(Q)}finally{E(!1)}};return d("div",{className:y.container,children:[d("div",{className:y.commandsContainer,children:[e($n,{className:y.commandButton,onClick:U,disabled:!x.current||w}),e(Ne,{className:y.commandButton,onClick:()=>n(!t)})]}),d("div",{className:y.chatRoot,children:[d("div",{className:y.chatContainer,children:[x.current?d("div",{className:y.chatMessageStream,children:[$.map((h,p)=>d("div",{children:[e(he,{message:h[0]}),e("div",{className:y.chatMessageGpt,children:e(fe,{answer:h[1],isSelected:H===p&&D!==void 0,onCitationClicked:Q=>se(Q,p),onThoughtProcessClicked:()=>_(k.ThoughtProcessTab,p),onSupportingContentClicked:()=>_(k.SupportingContentTab,p),onFollowupQuestionClicked:Q=>N(Q),onReadAnswerClicked:()=>A(h[1],p),showFollowupQuestions:v&&$.length-1===p},p)})]},p)),w&&d(ue,{children:[e(he,{message:x.current}),e("div",{className:y.chatMessageGptMinWidth,children:e(Wt,{})})]}),q?d(ue,{children:[e(he,{message:x.current}),e("div",{className:y.chatMessageGptMinWidth,children:e(ve,{error:q.toString(),onRetry:()=>N(x.current)})})]}):null,e("div",{ref:j})]}):d("div",{className:y.chatEmptyState,children:[e(tt,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e("h1",{className:y.chatEmptyStateTitle,children:"Chat with your data"}),e("h2",{className:y.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e(be,{onExampleClicked:W})]}),e("div",{className:y.chatInput,children:e(ye,{clearOnSend:!0,placeholder:"输入问题",disabled:w,onSend:h=>N(h)})})]}),$.length>0&&D&&e(Te,{className:y.chatAnalysisPanel,activeCitation:K,onActiveTabChanged:h=>_(h,H),citationHeight:"810px",answer:$[H][1],activeTab:D}),d(_e,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>n(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(Ce,{onClick:()=>n(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(V,{className:y.chatSettingsSeparator,defaultValue:a,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:Y}),e(Se,{className:y.chatSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:o.toString(),onChange:Z}),e(V,{className:y.chatSettingsSeparator,label:"排除类别",onChange:ne}),e(X,{className:y.chatSettingsSeparator,checked:u,label:"使用语义搜索",onChange:ee}),e(X,{className:y.chatSettingsSeparator,checked:r,label:"使用查询上下文摘要而不是整个文档",onChange:te,disabled:!u}),e(X,{className:y.chatSettingsSeparator,checked:v,label:"建议后续问题",onChange:oe})]})]})]})},Dn="_oneshotContainer_1x7b2_1",Qn="_oneshotTopSection_1x7b2_15",On="_oneshotBottomSection_1x7b2_29",Fn="_oneshotTitle_1x7b2_49",jn="_oneshotQuestionInput_1x7b2_77",Hn="_oneshotAnswerContainer_1x7b2_91",Gn="_oneshotAnalysisPanel_1x7b2_105",Un="_oneshotSettingsSeparator_1x7b2_115",Kn="_settingsButton_1x7b2_123",I={oneshotContainer:Dn,oneshotTopSection:Qn,oneshotBottomSection:On,oneshotTitle:Fn,oneshotQuestionInput:jn,oneshotAnswerContainer:Hn,oneshotAnalysisPanel:Gn,oneshotSettingsSeparator:Un,settingsButton:Kn},Vn=()=>{const[t,n]=s.useState(!1),[a,l]=s.useState(pe.BingSearch),[o,i]=s.useState(""),[u,f]=s.useState(""),[r,g]=s.useState(""),[c,m]=s.useState(3),[v,O]=s.useState(!1),[x,j]=s.useState(!1),[w,E]=s.useState(""),q=s.useRef(""),[M,K]=s.useState(!1),[L,D]=s.useState(),[T,H]=s.useState(),[G,$]=s.useState(),[z,N]=s.useState(void 0),U=async _=>{q.current=_,L&&D(void 0),K(!0),$(void 0),N(void 0);try{const A={question:_,approach:a,overrides:{promptTemplate:o.length===0?void 0:o,promptTemplatePrefix:u.length===0?void 0:u,promptTemplateSuffix:r.length===0?void 0:r,excludeCategory:w.length===0?void 0:w,top:c,semanticRanker:v,semanticCaptions:x}},h=await Pt(A);H(h)}catch(A){D(A)}finally{K(!1)}},Y=(_,A)=>{m(parseInt(A||"3"))},Z=(_,A)=>{O(!!A)},ee=(_,A)=>{j(!!A)},te=(_,A)=>{E(A||"")},ne=_=>{U(_)},oe=_=>{G===_&&z===k.CitationTab?N(void 0):($(_),N(k.CitationTab))},W=_=>{N(z===_?void 0:_)},se=()=>{alert("onReadAnswerClicked")};return pe.BingSearch,d("div",{className:I.oneshotContainer,children:[d("div",{className:I.oneshotTopSection,children:[e(Ne,{className:I.settingsButton,onClick:()=>n(!t)}),e("h1",{className:I.oneshotTitle,children:"Ask Bing"}),e("div",{className:I.oneshotQuestionInput,children:e(ye,{placeholder:"示例:面条是否可以用体外模拟进行GI测试？?",disabled:M,onSend:_=>U(_)})})]}),d("div",{className:I.oneshotBottomSection,children:[M&&e(Ie,{label:"正在生成回答"}),!q.current&&e(be,{onExampleClicked:ne}),!M&&T&&!L&&e("div",{className:I.oneshotAnswerContainer,children:e(fe,{answer:T,onCitationClicked:_=>oe(_),onThoughtProcessClicked:()=>W(k.ThoughtProcessTab),onSupportingContentClicked:()=>W(k.SupportingContentTab),onReadAnswerClicked:()=>se()})}),L?e("div",{className:I.oneshotAnswerContainer,children:e(ve,{error:L.toString(),onRetry:()=>U(q.current)})}):null,z&&T&&e(Te,{className:I.oneshotAnalysisPanel,activeCitation:G,onActiveTabChanged:_=>W(_),citationHeight:"600px",answer:T,activeTab:z})]}),d(_e,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>n(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(Ce,{onClick:()=>n(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(Se,{className:I.oneshotSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:c.toString(),onChange:Y}),e(V,{className:I.oneshotSettingsSeparator,label:"排除类别",onChange:te}),e(X,{className:I.oneshotSettingsSeparator,checked:v,label:"使用语义搜索",onChange:Z}),e(X,{className:I.oneshotSettingsSeparator,checked:x,label:"使用查询上下文摘要而不是整个文档",onChange:ee,disabled:!v})]})]})};nt();function Wn(){return e(De,{children:e(Oe,{children:d(ae,{path:"/",element:e(ft,{}),children:[e(ae,{index:!0,element:e(zn,{})}),e(ae,{path:"qa",element:e(Cn,{})}),e(ae,{path:"bing",element:e(Vn,{})}),e(ae,{path:"*",element:e(vt,{})})]})})})}$e.createRoot(document.getElementById("root")).render(e(qe.StrictMode,{children:e(Wn,{})}));
//# sourceMappingURL=index-11d68495.js.map
