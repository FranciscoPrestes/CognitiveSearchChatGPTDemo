import{j as me,r as h,a as Ie}from"./react-c38c8745.js";import{a as Ee,c as qe}from"./react-dom-5ae3f19c.js";import{L as Be,N as ie,H as Me}from"./react-router-dom-903e54cb.js";import{O as ze,d as De,e as V}from"./react-router-fbafb2d8.js";import{S as Ce,A as fe,a as $e,R as X,b as Qe,C as Oe,c as Fe}from"./microsoft-cognitiveservices-speech-sdk-b572f3ad.js";import{p as Se}from"./dompurify-76a5efca.js";import{S as je,a as T,I as ce,E as He,P as Ue,T as j,B as Ge,b as Ke,c as Ve,d as le,e as We,f as ve,g as Je,h as ye,D as be,C as Xe,i as Ne,j as J,k as Ye,l as Ze,m as et}from"./@fluentui-c38950ce.js";import{J as tt,i as nt}from"./@react-spring-b82638ed.js";import{m as ot}from"./uploader-3eb399a9.js";import{m as at}from"./react-uploader-2b05ffee.js";import"./@upload-io-528e2b93.js";import"./scheduler-04ce0582.js";import"./@remix-run-88f74c5a.js";import"./bent-0bd6329b.js";import"./uuid-a960c1f4.js";import"./tslib-14a4c710.js";import"./@microsoft-31b40247.js";import"./@griffel-370bb516.js";import"./rtl-css-js-4ed993c7.js";import"./@emotion-8a8e73f6.js";import"./preact-3c67df03.js";import"./upload-js-e5d126b1.js";import"./progress-smoother-d5015ad4.js";import"./classnames-7e4e529b.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&i(p)}).observe(document,{childList:!0,subtree:!0});function a(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=a(o);fetch(o.href,s)}})();const he=me.Fragment,e=me.jsx,l=me.jsxs;const st="/assets/github-fab00c2d.svg",rt="_layout_o4bzc_1",it="_header_o4bzc_13",ct="_headerContainer_o4bzc_23",lt="_headerTitleContainer_o4bzc_39",dt="_headerLogo_o4bzc_55",ut="_headerTitle_o4bzc_39",ht="_headerNavList_o4bzc_73",pt="_headerNavPageLink_o4bzc_85",mt="_headerNavPageLinkActive_o4bzc_113",gt="_headerNavLeftMargin_o4bzc_123",_t="_headerRightText_o4bzc_131",Ct="_microsoftLogo_o4bzc_141",ft="_githubLogo_o4bzc_151",y={layout:rt,header:it,headerContainer:ct,headerTitleContainer:lt,headerLogo:dt,headerTitle:ut,headerNavList:ht,headerNavPageLink:pt,headerNavPageLinkActive:mt,headerNavLeftMargin:gt,headerRightText:_t,microsoftLogo:Ct,githubLogo:ft},St=()=>l("div",{className:y.layout,children:[e("header",{className:y.header,role:"banner",children:l("div",{className:y.headerContainer,children:[e(Be,{to:"/",className:y.headerTitleContainer,children:e("h3",{className:y.headerTitle,children:"GPT + Enterprise data | Sample"})}),e("nav",{children:l("ul",{className:y.headerNavList,children:[e("li",{children:e(ie,{to:"/",className:({isActive:t})=>t?y.headerNavPageLinkActive:y.headerNavPageLink,children:"Chat"})}),e("li",{className:y.headerNavLeftMargin,children:e(ie,{to:"/qa",className:({isActive:t})=>t?y.headerNavPageLinkActive:y.headerNavPageLink,children:"Ask a question"})}),e("li",{className:y.headerNavLeftMargin,children:e(ie,{to:"/files",className:({isActive:t})=>t?y.headerNavPageLinkActive:y.headerNavPageLink,children:"Files Viewer"})}),e("li",{className:y.headerNavLeftMargin,children:e("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e("img",{src:st,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:y.githubLogo})})})]})}),e("h4",{className:y.headerRightText,children:"Azure OpenAI + Cognitive Search"})]})}),e(ze,{})]}),vt=()=>e("h1",{children:"404"}),yt="_oneshotContainer_1x7b2_1",bt="_oneshotTopSection_1x7b2_15",Nt="_oneshotBottomSection_1x7b2_29",Tt="_oneshotTitle_1x7b2_49",kt="_oneshotQuestionInput_1x7b2_77",wt="_oneshotAnswerContainer_1x7b2_91",xt="_oneshotAnalysisPanel_1x7b2_105",Rt="_oneshotSettingsSeparator_1x7b2_115",At="_settingsButton_1x7b2_123",b={oneshotContainer:yt,oneshotTopSection:bt,oneshotBottomSection:Nt,oneshotTitle:Tt,oneshotQuestionInput:kt,oneshotAnswerContainer:wt,oneshotAnalysisPanel:xt,oneshotSettingsSeparator:Rt,settingsButton:At};async function Lt(t){var i,o,s,p,S,r,C,d;const n=await fetch("/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:t.question,approach:t.approach,overrides:{semantic_ranker:(i=t.overrides)==null?void 0:i.semanticRanker,semantic_captions:(o=t.overrides)==null?void 0:o.semanticCaptions,top:(s=t.overrides)==null?void 0:s.top,temperature:(p=t.overrides)==null?void 0:p.temperature,prompt_template:(S=t.overrides)==null?void 0:S.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(C=t.overrides)==null?void 0:C.promptTemplateSuffix,exclude_category:(d=t.overrides)==null?void 0:d.excludeCategory}})}),a=await n.json();if(n.status>299||!n.ok)throw Error(a.error||"Unknown error");return a}async function Pt(t){var i,o,s,p,S,r,C,d,m;const n=await fetch("/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:t.history,approach:t.approach,overrides:{semantic_ranker:(i=t.overrides)==null?void 0:i.semanticRanker,semantic_captions:(o=t.overrides)==null?void 0:o.semanticCaptions,top:(s=t.overrides)==null?void 0:s.top,temperature:(p=t.overrides)==null?void 0:p.temperature,prompt_template:(S=t.overrides)==null?void 0:S.promptTemplate,prompt_template_prefix:(r=t.overrides)==null?void 0:r.promptTemplatePrefix,prompt_template_suffix:(C=t.overrides)==null?void 0:C.promptTemplateSuffix,exclude_category:(d=t.overrides)==null?void 0:d.excludeCategory,suggest_followup_questions:(m=t.overrides)==null?void 0:m.suggestFollowupQuestions}})}),a=await n.json();if(n.status>299||!n.ok)throw Error(a.error||"Unknown error");return a}async function It(t){const n="e985cb0392ad45d59681a396b208ebcf",a="southcentralus";var i=Ce.fromSubscription(n,a);const o=fe.fromDefaultSpeakerOutput();i.speechSynthesisVoiceName="zh-CN-YunxiNeural";const s=new $e(i,o),S=t.answer.replace(/\[[^\]]*\]/g,"");console.log(t.answer),s.speakTextAsync(S,function(r){r.reason===X.SynthesizingAudioCompleted?console.log("synthesis finished."):console.error("Speech synthesis canceled, "+r.errorDetails+`
Did you set the speech resource key and region values?`),s.close()},function(r){console.trace("err - "+r),s.close()})}function Et(t){return`/content/${t}`}var I=(t=>(t.RetrieveThenRead="rtr",t.ReadRetrieveRead="rrr",t.ReadDecomposeAsk="rda",t))(I||{});const qt="_answerContainer_1tryd_1",Bt="_answerLogo_1tryd_17",Mt="_answerText_1tryd_25",zt="_selected_1tryd_43",Dt="_citationLearnMore_1tryd_51",$t="_citation_1tryd_51",Qt="_followupQuestionsList_1tryd_95",Ot="_followupQuestionLearnMore_1tryd_103",Ft="_followupQuestion_1tryd_95",jt="_supContainer_1tryd_141",Ht="_retryButton_1tryd_199",Ut="_loadingdots_1tryd_243",Gt="_loading_1tryd_243",N={answerContainer:qt,answerLogo:Bt,answerText:Mt,selected:zt,citationLearnMore:Dt,citation:$t,followupQuestionsList:Qt,followupQuestionLearnMore:Ot,followupQuestion:Ft,supContainer:jt,retryButton:Ht,loadingdots:Ut,loading:Gt};function Kt(t,n){const a=[],i=[];let o=t.replace(/<<([^>>]+)>>/g,(r,C)=>(i.push(C),""));o=o.trim();const s=o.split(/\[([^\]]+)\]+\(([^\)]+)\)/g);console.log(s);let p=o.match(/\[([^\]]+)\]+\(([^\)]+)\)/g);return console.log(p),p&&p.map((r,C)=>{const d=r.split("]")[0].replace("[",""),m=r.split("]")[1].replace("(","").replace(")","");console.log(d),console.log(m),a.push({id:C,name:d,path:m})}),{answerHtml:s.map((r,C)=>{if(C%3===0)return r;if(C%3==1){let d=a.find(q=>q.name==r),m=d?d.id:-1;m!==-1?m=d?d.id+1:-1:m=a.length;const v=Et(r);return Ee(e("a",{className:"supContainer",title:r,onClick:()=>n(v),children:e("sup",{children:m})}))}else return""}).join(""),citations:a,followupQuestions:i}}const Te=()=>e(je,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),ke=({answer:t,isSelected:n,onCitationClicked:a,onThoughtProcessClicked:i,onSupportingContentClicked:o,onFollowupQuestionClicked:s,onReadAnswerClicked:p,showFollowupQuestions:S})=>{const r=h.useMemo(()=>Kt(t.answer,a),[t]),C=Se.sanitize(r.answerHtml);return l(T,{className:`${N.answerContainer} ${n&&N.selected}`,verticalAlign:"space-between",children:[e(T.Item,{children:l(T,{horizontal:!0,horizontalAlign:"space-between",children:[e(Te,{}),l("div",{children:[e(ce,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>i(),disabled:!t.thoughts}),e(ce,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>o(),disabled:!t.data_points.length}),e(ce,{style:{color:"black"},iconProps:{iconName:"ReadOutLoud"},title:"Read answer",ariaLabel:"Read answer",onClick:()=>p(),disabled:!t.answer})]})]})}),e(T.Item,{grow:!0,children:e("div",{className:N.answerText,dangerouslySetInnerHTML:{__html:C}})}),!!r.citations.length&&e(T.Item,{children:l(T,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e("span",{className:N.citationLearnMore,children:"来源:"}),r.citations.map((d,m)=>{const v=d.path;return e("a",{className:N.citation,title:d.name,onClick:()=>a(v),children:`${++m}. ${d.name}`},m)})]})}),!!r.followupQuestions.length&&S&&s&&e(T.Item,{children:l(T,{horizontal:!0,wrap:!0,className:`${r.citations.length?N.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e("span",{className:N.followupQuestionLearnMore,children:"您可能还想问:"}),r.followupQuestions.map((d,m)=>e("a",{className:N.followupQuestion,title:d,onClick:()=>s(d),children:`${d}`},m))]})})]})},Vt=()=>{const t=tt({from:{opacity:0},to:{opacity:1}});return e(nt.div,{style:{...t},children:l(T,{className:N.answerContainer,verticalAlign:"space-between",children:[e(Te,{}),e(T.Item,{grow:!0,children:l("p",{className:N.answerText,children:["正在生成回答",e("span",{className:N.loadingdots})]})})]})})},we=({error:t,onRetry:n})=>l(T,{className:N.answerContainer,verticalAlign:"space-between",children:[e(He,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e(T.Item,{grow:!0,children:e("p",{className:N.answerText,children:t})}),e(Ue,{className:N.retryButton,onClick:n,text:"Retry"})]}),Wt="_questionInputContainer_wokwf_1",Jt="_questionInputTextArea_wokwf_19",Xt="_questionInputButtonsContainer_wokwf_29",Yt="_questionInputSendButton_wokwf_41",Zt="_questionInputSendButtonDisabled_wokwf_49",F={questionInputContainer:Wt,questionInputTextArea:Jt,questionInputButtonsContainer:Xt,questionInputSendButton:Yt,questionInputSendButtonDisabled:Zt},xe=({onSend:t,disabled:n,placeholder:a,clearOnSend:i})=>{const[o,s]=h.useState(""),p=()=>{if(n||!o.trim()){console.log("send disabled"),console.log("question: "+o);return}t(o),i&&s("")},S=()=>{const m="e985cb0392ad45d59681a396b208ebcf",v="southcentralus";var q=Ce.fromSubscription(m,v);const k=fe.fromDefaultMicrophoneInput();q.speechRecognitionLanguage="zh-CN";const $=new Qe(q,k);$.recognizeOnceAsync(w=>{switch(w.reason){case X.RecognizedSpeech:console.log(`RECOGNIZED: Text=${w.text}`),s(w.text);break;case X.NoMatch:console.log("NOMATCH: Speech could not be recognized.");break;case X.Canceled:const L=Oe.fromResult(w);console.log(`CANCELED: Reason=${L.reason}`),L.reason==Fe.Error&&(console.log(`CANCELED: ErrorCode=${L.ErrorCode}`),console.log(`CANCELED: ErrorDetails=${L.errorDetails}`),console.log("CANCELED: Did you set the speech resource key and region values?"));break}$.close()})},r=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),p())},C=(m,v)=>{v?v.length<=1e3&&s(v):s("")},d=n||!o.trim();return l(T,{horizontal:!0,className:F.questionInputContainer,children:[e(j,{className:F.questionInputTextArea,placeholder:a,multiline:!0,resizable:!1,borderless:!0,value:o,onChange:C,onKeyDown:r}),l("div",{className:F.questionInputButtonsContainer,children:[e("div",{className:`${F.questionInputSendButton} ${d?F.questionInputSendButtonDisabled:""}`,"aria-label":"语音输入",onClick:S,children:e(Ge,{primaryFill:"rgba(115, 118, 225, 1)"})}),e("div",{className:`${F.questionInputSendButton} ${d?F.questionInputSendButtonDisabled:""}`,"aria-label":"提问按钮",onClick:p,children:e(Ke,{primaryFill:"rgba(115, 118, 225, 1)"})})]})]})},en="_examplesNavList_v5q0z_1",tn="_example_v5q0z_1",nn="_exampleText_v5q0z_53",pe={examplesNavList:en,example:tn,exampleText:nn},on=({text:t,value:n,onClick:a})=>e("div",{className:pe.example,onClick:()=>a(n),children:e("p",{className:pe.exampleText,children:t})}),an=[{text:"正常DMS计算公式是什么?",value:"正常DMS计算公式是什么?"},{text:"进货未销定义是什么?",value:"进货未销定义?"},{text:"APP与OSPC端门店货源查询退货状态不一致 门店商品退货状态系统逻辑?",value:"APP与OSPC端门店货源查询退货状态不一致 门店商品退货状态系统逻辑?"}],Re=({onExampleClicked:t})=>e("ul",{className:pe.examplesNavList,children:an.map((n,a)=>e("li",{children:e(on,{text:n.text,value:n.value,onClick:t})},a))}),sn="_thoughtProcess_exr0t_1",rn={thoughtProcess:sn};function cn(t){const n=t.split(": "),a=n[0];var i=n.slice(1).join(": ")?n.slice(1).join(": "):"No content";const o=i.match(/<([^>]+)>/);return i=i.replace(/<([^>]+)>/g,""),{title:a,content:i,url:o?o[1]:""}}const ln="_supportingContentNavList_ekyxv_1",dn="_supportingContentItem_ekyxv_17",un="_supportingContentItemHeader_ekyxv_41",hn="_supportingContentItemText_ekyxv_49",W={supportingContentNavList:ln,supportingContentItem:dn,supportingContentItemHeader:un,supportingContentItemText:hn},pn=({supportingContent:t})=>e("ul",{className:W.supportingContentNavList,children:t.map((n,a)=>{const i=cn(n);return l("li",{className:W.supportingContentItem,children:[e("h4",{className:W.supportingContentItemHeader,children:i.title}),e("p",{className:W.supportingContentItemText,children:i.content}),e("a",{className:W.supportingContentItemText,href:i.url,target:"_blank",children:i.url})]})})});var x=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(x||{});const de={disabled:!0,style:{color:"grey"}},Ae=({answer:t,activeTab:n,activeCitation:a,citationHeight:i,className:o,onActiveTabChanged:s})=>{const p=!t.thoughts,S=!t.data_points.length,r=!a,C=Se.sanitize(t.thoughts);return l(Ve,{className:o,selectedKey:n,onLinkClick:d=>d&&s(d.props.itemKey),children:[e(le,{itemKey:x.ThoughtProcessTab,headerText:"思维过程",headerButtonProps:p?de:void 0,children:e("div",{className:rn.thoughtProcess,dangerouslySetInnerHTML:{__html:C}})}),e(le,{itemKey:x.SupportingContentTab,headerText:"支持内容",headerButtonProps:S?de:void 0,children:e(pn,{supportingContent:t.data_points})}),e(le,{itemKey:x.CitationTab,headerText:"引用",headerButtonProps:r?de:void 0,children:e("iframe",{title:"引用",src:a,width:"100%",height:i})})]})},mn="_container_1k5c7_1",gn={container:mn},Le=({className:t,onClick:n})=>l("div",{className:`${gn.container} ${t??""}`,onClick:n,children:[e(We,{}),e(ve,{children:"开发人员配置"})]}),_n=()=>{const[t,n]=h.useState(!1),[a,i]=h.useState(I.ReadDecomposeAsk),[o,s]=h.useState(""),[p,S]=h.useState(""),[r,C]=h.useState(""),[d,m]=h.useState(3),[v,q]=h.useState(!1),[k,$]=h.useState(!1),[w,L]=h.useState(""),B=h.useRef(""),[M,U]=h.useState(!1),[z,D]=h.useState(),[R,Q]=h.useState(),[H,E]=h.useState(),[O,P]=h.useState(void 0),G=async g=>{B.current=g,z&&D(void 0),U(!0),E(void 0),P(void 0);try{const _={question:g,approach:a,overrides:{promptTemplate:o.length===0?void 0:o,promptTemplatePrefix:p.length===0?void 0:p,promptTemplateSuffix:r.length===0?void 0:r,excludeCategory:w.length===0?void 0:w,top:d,semanticRanker:v,semanticCaptions:k}},Pe=await Lt(_);Q(Pe)}catch(_){D(_)}finally{U(!1)}},Y=(g,_)=>{s(_||"")},Z=(g,_)=>{S(_||"")},ee=(g,_)=>{C(_||"")},te=(g,_)=>{m(parseInt(_||"3"))},ne=(g,_)=>{i((_==null?void 0:_.key)||I.RetrieveThenRead)},oe=(g,_)=>{q(!!_)},ae=(g,_)=>{$(!!_)},se=(g,_)=>{L(_||"")},K=g=>{G(g)},re=g=>{H===g&&O===x.CitationTab?P(void 0):(E(g),P(x.CitationTab))},c=g=>{P(O===g?void 0:g)},u=()=>{alert("onReadAnswerClicked")},A=[{key:I.RetrieveThenRead,text:"Retrieve-Then-Read"},{key:I.ReadRetrieveRead,text:"Read-Retrieve-Read"},{key:I.ReadDecomposeAsk,text:"Read-Decompose-Ask"}];return l("div",{className:b.oneshotContainer,children:[l("div",{className:b.oneshotTopSection,children:[e(Le,{className:b.settingsButton,onClick:()=>n(!t)}),e("h1",{className:b.oneshotTitle,children:"Ask your data"}),e("div",{className:b.oneshotQuestionInput,children:e(xe,{placeholder:"示例:面条是否可以用体外模拟进行GI测试？?",disabled:M,onSend:g=>G(g)})})]}),l("div",{className:b.oneshotBottomSection,children:[M&&e(Je,{label:"正在生成回答"}),!B.current&&e(Re,{onExampleClicked:K}),!M&&R&&!z&&e("div",{className:b.oneshotAnswerContainer,children:e(ke,{answer:R,onCitationClicked:g=>re(g),onThoughtProcessClicked:()=>c(x.ThoughtProcessTab),onSupportingContentClicked:()=>c(x.SupportingContentTab),onReadAnswerClicked:()=>u()})}),z?e("div",{className:b.oneshotAnswerContainer,children:e(we,{error:z.toString(),onRetry:()=>G(B.current)})}):null,O&&R&&e(Ae,{className:b.oneshotAnalysisPanel,activeCitation:H,onActiveTabChanged:g=>c(g),citationHeight:"600px",answer:R,activeTab:O})]}),l(ye,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>n(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(be,{onClick:()=>n(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(Xe,{className:b.oneshotSettingsSeparator,label:"方式",options:A,defaultSelectedKey:a,onChange:ne}),(a===I.RetrieveThenRead||a===I.ReadDecomposeAsk)&&e(j,{className:b.oneshotSettingsSeparator,defaultValue:o,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:Y}),a===I.ReadRetrieveRead&&l(he,{children:[e(j,{className:b.oneshotSettingsSeparator,defaultValue:p,label:"更改提问前缀模板",multiline:!0,autoAdjustHeight:!0,onChange:Z}),e(j,{className:b.oneshotSettingsSeparator,defaultValue:r,label:"更改提问后缀模板",multiline:!0,autoAdjustHeight:!0,onChange:ee})]}),e(Ne,{className:b.oneshotSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:d.toString(),onChange:te}),e(j,{className:b.oneshotSettingsSeparator,label:"排除类别",onChange:se}),e(J,{className:b.oneshotSettingsSeparator,checked:v,label:"使用语义搜索",onChange:oe}),e(J,{className:b.oneshotSettingsSeparator,checked:k,label:"使用查询上下文摘要而不是整个文档",onChange:ae,disabled:!v})]})]})},Cn="_container_1qf1y_1",fn="_chatRoot_1qf1y_15",Sn="_chatContainer_1qf1y_25",vn="_chatEmptyState_1qf1y_41",yn="_chatEmptyStateTitle_1qf1y_61",bn="_chatEmptyStateSubtitle_1qf1y_75",Nn="_chatMessageStream_1qf1y_107",Tn="_chatMessageGpt_1qf1y_131",kn="_chatMessageGptMinWidth_1qf1y_145",wn="_chatInput_1qf1y_155",xn="_chatAnalysisPanel_1qf1y_181",Rn="_chatSettingsSeparator_1qf1y_197",An="_loadingLogo_1qf1y_205",Ln="_commandsContainer_1qf1y_213",Pn="_commandButton_1qf1y_223",f={container:Cn,chatRoot:fn,chatContainer:Sn,chatEmptyState:vn,chatEmptyStateTitle:yn,chatEmptyStateSubtitle:bn,chatMessageStream:Nn,chatMessageGpt:Tn,chatMessageGptMinWidth:kn,chatInput:wn,chatAnalysisPanel:xn,chatSettingsSeparator:Rn,loadingLogo:An,commandsContainer:Ln,commandButton:Pn},In="_container_u4tj7_1",En="_message_u4tj7_17",ge={container:In,message:En},ue=({message:t})=>e("div",{className:ge.container,children:e("div",{className:ge.message,children:t})}),qn="_container_7708a_1",Bn="_disabled_7708a_15",_e={container:qn,disabled:Bn},Mn=({className:t,disabled:n,onClick:a})=>l("div",{className:`${_e.container} ${t??""} ${n&&_e.disabled}`,onClick:a,children:[e(Ye,{}),e(ve,{children:"清空对话"})]}),zn=()=>{const[t,n]=h.useState(!1),[a,i]=h.useState(""),[o,s]=h.useState(3),[p,S]=h.useState(!1),[r,C]=h.useState(!1),[d,m]=h.useState(""),[v,q]=h.useState(!0),k=h.useRef(""),$=h.useRef(null),[w,L]=h.useState(!1),[B,M]=h.useState(),[U,z]=h.useState(),[D,R]=h.useState(void 0),[Q,H]=h.useState(0),[E,O]=h.useState([]),P=async c=>{k.current=c,B&&M(void 0),L(!0),z(void 0),R(void 0);try{const A={history:[...E.map(_=>({user:_[0],bot:_[1].answer})),{user:c,bot:void 0}],approach:I.ReadRetrieveRead,overrides:{promptTemplate:a.length===0?void 0:a,excludeCategory:d.length===0?void 0:d,top:o,semanticRanker:p,semanticCaptions:r,suggestFollowupQuestions:v}},g=await Pt(A);O([...E,[c,g]])}catch(u){M(u)}finally{L(!1)}},G=()=>{k.current="",B&&M(void 0),z(void 0),R(void 0),O([])};h.useEffect(()=>{var c;return(c=$.current)==null?void 0:c.scrollIntoView({behavior:"smooth"})},[w]);const Y=(c,u)=>{i(u||"")},Z=(c,u)=>{s(parseInt(u||"3"))},ee=(c,u)=>{S(!!u)},te=(c,u)=>{C(!!u)},ne=(c,u)=>{m(u||"")},oe=(c,u)=>{q(!!u)},ae=c=>{P(c)},se=(c,u)=>{U===c&&D===x.CitationTab&&Q===u?R(void 0):(z(c),R(x.CitationTab)),H(u)},K=(c,u)=>{R(D===c&&Q===u?void 0:c),H(u)},re=async(c,u)=>{H(u);try{const A={answer:c.answer};await It(A)}catch(A){M(A)}finally{L(!1)}};return l("div",{className:f.container,children:[l("div",{className:f.commandsContainer,children:[e(Mn,{className:f.commandButton,onClick:G,disabled:!k.current||w}),e(Le,{className:f.commandButton,onClick:()=>n(!t)})]}),l("div",{className:f.chatRoot,children:[l("div",{className:f.chatContainer,children:[k.current?l("div",{className:f.chatMessageStream,children:[E.map((c,u)=>l("div",{children:[e(ue,{message:c[0]}),e("div",{className:f.chatMessageGpt,children:e(ke,{answer:c[1],isSelected:Q===u&&D!==void 0,onCitationClicked:A=>se(A,u),onThoughtProcessClicked:()=>K(x.ThoughtProcessTab,u),onSupportingContentClicked:()=>K(x.SupportingContentTab,u),onFollowupQuestionClicked:A=>P(A),onReadAnswerClicked:()=>re(c[1],u),showFollowupQuestions:v&&E.length-1===u},u)})]},u)),w&&l(he,{children:[e(ue,{message:k.current}),e("div",{className:f.chatMessageGptMinWidth,children:e(Vt,{})})]}),B?l(he,{children:[e(ue,{message:k.current}),e("div",{className:f.chatMessageGptMinWidth,children:e(we,{error:B.toString(),onRetry:()=>P(k.current)})})]}):null,e("div",{ref:$})]}):l("div",{className:f.chatEmptyState,children:[e(Ze,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e("h1",{className:f.chatEmptyStateTitle,children:"Chat with your data"}),e("h2",{className:f.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e(Re,{onExampleClicked:ae})]}),e("div",{className:f.chatInput,children:e(xe,{clearOnSend:!0,placeholder:"输入问题",disabled:w,onSend:c=>P(c)})})]}),E.length>0&&D&&e(Ae,{className:f.chatAnalysisPanel,activeCitation:U,onActiveTabChanged:c=>K(c,Q),citationHeight:"810px",answer:E[Q][1],activeTab:D}),l(ye,{headerText:"配置",isOpen:t,isBlocking:!1,onDismiss:()=>n(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e(be,{onClick:()=>n(!1),children:"Close"}),isFooterAtBottom:!0,children:[e(j,{className:f.chatSettingsSeparator,defaultValue:a,label:"更改提问模板",multiline:!0,autoAdjustHeight:!0,onChange:Y}),e(Ne,{className:f.chatSettingsSeparator,label:"最多从搜索中返回的条目数量:",min:1,max:50,defaultValue:o.toString(),onChange:Z}),e(j,{className:f.chatSettingsSeparator,label:"排除类别",onChange:ne}),e(J,{className:f.chatSettingsSeparator,checked:p,label:"使用语义搜索",onChange:ee}),e(J,{className:f.chatSettingsSeparator,checked:r,label:"使用查询上下文摘要而不是整个文档",onChange:te,disabled:!p}),e(J,{className:f.chatSettingsSeparator,checked:v,label:"建议后续问题",onChange:oe})]})]})]})},Dn={},$n=ot.Uploader({apiKey:"free"}),Qn=()=>{const t={multi:!0,showFinishButton:!0,styles:{colors:{primary:"#377dff"}}};return l("div",{children:[e("div",{className:Dn.files}),e("div",{children:e(at.UploadDropzone,{uploader:$n,options:t,onUpdate:n=>console.log(n.map(a=>a.fileUrl).join(`
`)),onComplete:n=>alert(n.map(a=>a.fileUrl).join(`
`)),width:"600px",height:"375px"})})]})};et();function On(){return e(Me,{children:e(De,{children:l(V,{path:"/",element:e(St,{}),children:[e(V,{index:!0,element:e(zn,{})}),e(V,{path:"qa",element:e(_n,{})}),e(V,{path:"files",element:e(Qn,{})}),e(V,{path:"*",element:e(vt,{})})]})})})}qe.createRoot(document.getElementById("root")).render(e(Ie.StrictMode,{children:e(On,{})}));
//# sourceMappingURL=index-b52cac6f.js.map
